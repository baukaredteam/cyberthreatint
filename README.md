# üõ°Ô∏è Phishing Monitor

–°–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –¥–ª—è SOC –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ Certstream –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–º–µ–Ω—ã –Ω–∞ —Å—Ö–æ–∂–µ—Å—Ç—å —Å –¥–æ–º–µ–Ω–∞–º–∏ –≤–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —á–µ—Ä–µ–∑ Certstream API
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ö–æ–∂–µ—Å—Ç–∏** –¥–æ–º–µ–Ω–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –±–∞–∑–∞–º–∏ —Ñ–∏—à–∏–Ω–≥–∞**:
  - NRD (Newly Registered Domains)
  - Phishing Database
  - Hagezi DNS Blocklists
- **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** –ø–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º —É–≥—Ä–æ–∑–∞–º
- **SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞** –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.21+
- SQLite3
- Telegram Bot Token
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Certstream

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd phishing-monitor
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`:

```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here
CLIENT_DOMAINS=qazpost.kz,yourcompany.com,client.org
SIMILARITY_THRESHOLD=0.8
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
go mod download
```

### 4. –ó–∞–ø—É—Å–∫

```bash
go run cmd/monitor/main.go
```

## üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker Compose

```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

# –ó–∞–ø—É—Å–∫
docker-compose up -d
```

### –†—É—á–Ω–∞—è —Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞

```bash
docker build -t phishing-monitor .
docker run -d --name phishing-monitor \
  -e TELEGRAM_BOT_TOKEN=your_token \
  -e TELEGRAM_CHAT_ID=your_chat_id \
  -e CLIENT_DOMAINS=qazpost.kz,example.com \
  -v $(pwd)/data:/app/data \
  phishing-monitor
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | - |
| `TELEGRAM_CHAT_ID` | ID —á–∞—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | - |
| `CLIENT_DOMAINS` | –î–æ–º–µ–Ω—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) | `qazpost.kz,example.com` |
| `CERTSTREAM_URL` | URL Certstream WebSocket | `wss://certstream.calidog.io` |
| `DATABASE_PATH` | –ü—É—Ç—å –∫ SQLite –±–∞–∑–µ | `./data/phishing.db` |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `info` |
| `UPDATE_INTERVAL` | –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑ (–º–∏–Ω) | `60` |
| `SIMILARITY_THRESHOLD` | –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏ (0.0-1.0) | `0.8` |

### –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot` –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
3. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
4. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ Chat ID

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Chat ID:
```bash
curl "https://api.telegram.org/bot<BOT_TOKEN>/getUpdates"
```

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Certstream –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
2. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤**: –ü–∞—Ä—Å–∏–Ω–≥ CN –∏ SAN –ø–æ–ª–µ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
3. **–ê–Ω–∞–ª–∏–∑ —Å—Ö–æ–∂–µ—Å—Ç–∏**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–æ–º–µ–Ω–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—è:
   - –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫
   - –ê–Ω–∞–ª–∏–∑ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–∞—Ö**: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –±–∞–∑–∞–º–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤
5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Telegram —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ñ–∏—à–∏–Ω–≥–∞

- **NRD**: –ù–æ–≤—ã–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã —Å DGA –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
- **Phishing Database**: –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –±–∞–∑–∞ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- **Hagezi**: DNS –±–ª–æ–∫-–ª–∏—Å—Ç—ã

## üì± Telegram –∫–æ–º–∞–Ω–¥—ã

- `/start` - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ—Ç–∞
- `/status` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á–µ—Ç—ã

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ 9:00 UTC –∏ –≤–∫–ª—é—á–∞—é—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º
- –î–æ–º–µ–Ω—ã –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∏—Å–∫–∞
- –¢—Ä–µ–Ω–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –£—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞

- üî¥ **HIGH**: –°—Ö–æ–∂–µ—Å—Ç—å >95% –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- üü° **MEDIUM**: –°—Ö–æ–∂–µ—Å—Ç—å 85-95%
- üü¢ **LOW**: –°—Ö–æ–∂–µ—Å—Ç—å 80-85%

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
phishing-monitor/
‚îú‚îÄ‚îÄ cmd/monitor/          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ config/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îú‚îÄ‚îÄ certstream/      # –ö–ª–∏–µ–Ω—Ç Certstream
‚îÇ   ‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ phishing/        # –î–µ—Ç–µ–∫—Ç–æ—Ä —Ñ–∏—à–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ storage/         # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ telegram/        # Telegram –±–æ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ updater/         # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ data/                # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
‚îú‚îÄ‚îÄ docker-compose.yml   # Docker Compose
‚îú‚îÄ‚îÄ Dockerfile          # Docker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
go mod download

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
go test ./...

# –°–±–æ—Ä–∫–∞
go build -o phishing-monitor cmd/monitor/main.go

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
go fmt ./...
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (`git checkout -b feature/amazing-feature`)
3. –°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç (`git commit -m 'Add amazing feature'`)
4. –ó–∞–ø—É—à—å—Ç–µ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## ‚ö†Ô∏è –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–µ–≥–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∞—à–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –∏–ª–∏ –¥–æ–º–µ–Ω–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∏—Ö —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è. –ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –Ω–µ–ø—Ä–∞–≤–æ–º–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –°–æ–∑–¥–∞–π—Ç–µ [Issue](https://github.com/your-repo/phishing-monitor/issues)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [FAQ](https://github.com/your-repo/phishing-monitor/wiki/FAQ)
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ [Discussions](https://github.com/your-repo/phishing-monitor/discussions)

---

–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è SOC –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤